<?xml version="1.0" ?>
<openerp>
    <data>

        <!-- add link to the standard footer -->
        <template id="slide_footer" inherit_id="website.footer_default"
            name="Footer Slides Link">
            <xpath expr="//div[@id='info']//ul[@class='list-unstyled']" position="inside">
                <li>
                    <a href="/channel">Presentations</a>
                </li>
                <li>
                    <a href="/channel">Videos</a>
                </li>
            </xpath>
        </template>

        <!-- header template to add scripts to all pages -->
        <template id="head" name="slides">
            <link href="/website_slides/static/src/css/website_slides.css" rel="stylesheet"/>
            <script type="text/javascript" src="/website_slides/static/src/js/slides.js"></script>			
        </template>

        <!-- search box -->
        <template id="search" name="search">
            <form action="/slides" role="search" method="get">
                <div class="input-group">
                    <input type="text" class="form-control" name="search" placeholder="Search Slides..." t-att-value="search"/>
                    <span class="input-group-btn">
                        <button class="btn btn-primary" type="submit">
                            <span class="glyphicon glyphicon-search"></span>
                        </button>
                    </span>
                </div>
            </form>
        </template>

        <template id='pdfview' name="Slide Viewer">
            <div class="row">
                <div class="panel panel-default" style="border-radius: 0px;">
                    <div class="panel-body" style="padding: 0px;">
                        <img id="pdfimage" class="img-responsive" src="" />
                    </div>
                    <div class="panel-footer" style="position: relative;">
                        <div class="text-center">
                            <a id="prev" href="#carousel-example-generic" role="button" data-slide="prev">
                                <i class="fa fa-chevron-circle-left fa-2x"></i>
                            </a>
                            <a id="next" href="#carousel-example-generic" role="button" data-slide="next">
                                <i class="fa fa-chevron-circle-right fa-2x"></i> 
                            </a>
                        </div>
                        <div class="text-muted" style="position: absolute;top: 15px;right: 15px;">
                            <spane id="page_num"></spane> of <span id="page_count"></span>
                        </div>
                    </div>
                </div>
            </div>
        </template>

        <template id='videoview' name="Video Viewer">
            <div class="row">
                <div class="panel panel-default" style="border-radius: 0px;">
                    <div class="panel-body" style="padding: 0px;">
                        <img t-if="famous.youtube_id" t-att-src="famous.image" style="width: 100%;" class="img-responsive"/>
                    </div>
                    <div class="panel-footer" style="position: relative;">
                        <div class="text-center">
                            Click to Play, Powred by YouTube.
                        </div>
                    </div>
                </div>
            </div>
        </template>

        <!-- entry page of the slide application -->
        <template id='home' name="Odoo Slides">
            <t t-set="head">
                <t t-call="website_slides.head"/>
                <script type="text/javascript" src="/website_slides/static/lib/pdfjs/build/pdf.js"></script>
                <script type="text/javascript" src="/website_slides/static/src/js/pdfviewer.js"></script>
            </t>
            <t t-call="website.layout">
                <div t-if="famous" class="wrap" style="background-color: #f8f8f8;color: #1c1c1c;border-bottom: 1px solid #CCCCCC;">
                    <section>
                        <div class="container">
                          <div class="row" style="padding-left: 15px;padding-right: 15px;">
                            <div class="col-md-5 mt16" t-if="famous.youtube_id" >
                                <a t-attf-href="/channel/#{slug(channel)}/view/#{slug(famous)}">
                                    <t t-call="website_slides.videoview"/>
                                </a>
                            </div>

                            <div class="col-md-5 mt16" t-if="not famous.youtube_id" >
                                <a t-attf-href="/channel/#{slug(channel)}/view/#{slug(famous)}">
                                    <t t-if="not famous.youtube_id and not famous.url" t-call="website_slides.pdfview"/>
                                </a>
                            </div>

                                    
                            <div class="col-md-7">
                                <h1 style="margin-top: 15px;"><t t-esc="channel.name"/></h1>
                                <p><t t-esc="channel.description"/></p>
                                <div>
                                    <div class="col-lg-1 col-md-1 col-sm-1 col-xs-2" style="padding: 0px;">
                                        <a t-attf-href="/channel/#{slug(channel)}">
                                            <img src="/website_slides/static/description/odoo-logo.jpg" class="img-responsive" style="border: 1px solid #CCC;"/>
                                        </a>
                                    </div>
                                    <div class="col-lg-11 col-md-11 col-sm-11 col-xs-11">
                                        <a t-attf-href="/channel/#{slug(channel)}">
                                            <p t-field="channel.name" class="mb0"/>
                                        </a>
                                        <div class="col-md-8" style="padding-left:0">
                                            <t t-call="website_mail.follow">
                                                <t t-set="email" t-value="user.email"/>
                                                <t t-set="object" t-value="channel"/>
                                            </t>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="padding: 0px;">
                                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="padding: 0px;">
                                    <h3 class="oe-slides-text-truncation">
                                        <a t-attf-href="/channel/#{slug(channel)}/view/#{slug(famous)}">
                                            <t t-esc="famous.name"/>
                                        </a>
                                    </h3>
                                    <div class="label label-success mb16 col-md-16" href="#">Most Viewed</div>
                                    
                                    <p t-if="famous.description"><t t-raw="famous.trim_lines(famous.description)"/></p>
                                    
                                    <div class="mt8 mb16 col-md-16" t-if="famous.tag_ids" style="padding-left: 0px;">
                                        <i class="fa fa-tags"></i>
                                        <t t-foreach="famous.tag_ids" t-as="att_tag">
                                            <a t-attf-href="/channel/#{slug(channel)}?tags=#{att_tag.name}">
                                                <span t-attf-class="badge slide-badge #{tags and tags == att_tag.name and 'badge-active' ''}" t-field="att_tag.name"/>
                                            </a>
                                        </t>
                                    </div>
                                </div>
                            </div>
                          </div>
                      </div>
                  </div>
              </section>
          </div>

          <div class="container">
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 mt16">
                    <div style="border-bottom: 1px solid #CCC;padding-bottom: 5px;">
                        <span>
                            <a class="label label-success" href="#">Presentations</a>
                            <a href="#">Videos</a>
                            <a href="#">Documents</a>
                        </span>

                        <span class="pull-right">
                            <a class="label label-danger" href="#">Latest</a>
                            <a href="#">Most Viewed</a>
                        </span>
                    </div>

                </div>
                <t t-call="website_slides.gridview"/>
                </div>

                <div class="row text-center">
                    <t t-call="website.pager"/>
                </div>
                </div>
            </t>
        </template>

        <!-- channel list, will be display if more then one channel available -->
        <template id='channels' name="Channels">
            <t t-set="head"><t t-call="website_slides.head"/></t>
            <t t-call="website.layout">
                <div class="oe_structure"/>
                <div class="container mt16">
                    <div class="row">
                        <div t-foreach="channels" t-as="channel" class="col-sm-4 mb32">
                            <t t-set="famous" t-value="channel.get_mostviewed(channel)"/> 
                            <div class="oe-channel-grid-thumbnail">
                                <a t-attf-href="/channel/#{slug(channel)}">
                                    <img t-if="not famous.youtube_id" t-attf-src="/slides/thumb/#{famous.id}" style="width: 100%;" class="img-responsive"/>
                                    <img t-if="famous.youtube_id" t-att-src="famous.image" style="width: 100%;" class="img-responsive"/>
                                </a>

                                <div style="padding: 5px;">
                                    <a t-attf-href="/channel/#{slug(channel)}">
                                        <h4 class="oe-slides-text-truncation">
                                            <t t-esc="channel.name"/>
                                        </h4>
                                    </a>
                                    <p t-field="channel.description"/>

                                    <t groups="base.group_public">
                                        <t t-set="public_user" t-value="True"/>
                                    </t>
                                    <t t-if="not public_user">
                                        <t t-call="website_mail.follow">
                                            <t t-set="email" t-value="user.email"/>
                                            <t t-set="object" t-value="channel"/>
                                        </t>
                                    </t>
                                    <t t-if="public_user">
                                        <t t-call="website_mail.follow">
                                            <t t-set="email" t-value="user.email"/>
                                            <t t-set="object" t-value="channel"/>
                                        </t>
                                    </t>
                                    <div class="mt8">
                                        <t t-call="website.publish_management">
                                            <t t-set="object" t-value="channel"/>
                                            <t t-set="publish_edit" t-value="True"/>
                                        </t>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </t>
        </template>

        <!-- display one slide -->
        <template id='slide_view' name="Odoo Slide">
            <t t-set="head">
                <t t-call="website_slides.head"/>
            </t>
            <t t-call="website.layout">
                <br/>
                <div class="container">
                    <div class="row">
                        <t t-call="website_slides.detailview"/>
                    </div>
                </div>
            </t>
        </template>

        <!-- slide grid view -->
        <template id='gridview' name="Slides">
            <div class="col-lg-3 col-md-4 col-sm-6 col-xs-12" style="margin-top: 15px;margin-bottom: 15px;"  t-foreach="attachment_ids" t-as="attachment">
                <div class="oe-slides-grid-thumbnail">
                    <a t-attf-href="/channel/#{slug(channel)}/view/#{slug(attachment)}#{url_for('') + '?' + keep_query( 'search', 'filters', 'sorting', 'tags')}">
                        <img t-if="not attachment.youtube_id" t-attf-src="/slides/thumb/#{attachment.id}" style="width: 100%;" class="img-responsive"/>
                        <img t-if="attachment.youtube_id" t-att-src="attachment.image" style="width: 100%;" class="img-responsive"/>
                    </a>

                    <span class="like-box" t-if="attachment.website_published">
                        <a href="#">
                            <div class="text-center">
                                <i class="fa fa-heart fa-2x" style="margin-top: 8px;color: white;"></i>Like
                            </div>
                        </a>
                    </span>

                    <span t-if="not attachment.website_published" class="label label-danger" style="position: absolute;right: 20px;top: 7px;">Not Published</span>

                    <div style="padding: 5px;">
                        <a t-attf-href="/channel/#{slug(channel)}/view/#{slug(attachment)}#{url_for('') + '?' + keep_query( 'search', 'filters', 'sorting', 'tags')}">
                            <h4 class="oe-slides-text-truncation">
                                <t t-esc="attachment.name"/>
                            </h4>
                        </a>
                        <div class="text-muted">
                            <small class="pull-left">
                                <t t-esc="attachment.slide_views" />
                                Views
                            </small>
                            <small class="pull-right">
                                <timeago class="timeago" t-att-title="attachment.create_date"></timeago>
                            </small>
                        </div>
                        <p t-if="attachment.tag_ids" class="oe-slides-text-truncation" style="padding-top: 5px;">
                            <!--i class="fa fa-tags"></i-->
                            <t t-foreach="attachment.tag_ids" t-as="att_tag">
                                <a t-attf-href="/channel/#{slug(channel)}/?tags=#{att_tag.name}">
                                    <span t-attf-class="badge slide-badge #{tags and tags == att_tag.name and 'badge-active' ''}" t-field="att_tag.name"/>
                                </a>
                            </t>
                        </p>
                    </div>
                </div>
            </div>
        </template>

        <!-- slide detail view -->
        <template id='detailview' name="Slide Detail">
            <div class="col-lg-9 col-md-9 col-sm-12 col-xs-12">
                <div t-if="slideview.datas" class="embed-responsive embed-responsive-4by3 embed-responsive-item">
                    <iframe t-attf-src="/website_slides/static/lib/pdfjs/web/viewer.html?file=#{slideview.url}"></iframe>
                </div>
                <div t-if="slideview.youtube_id" class="embed-responsive embed-responsive-16by9 embed-responsive-item">
                    <iframe t-attf-src="//www.youtube.com/embed/#{slideview.youtube_id}?theme=light"></iframe>
                </div>
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="padding: 0px;">
                    <h3 class="oe-slides-text-truncation">
                        <t t-esc="slideview.name"/>
                    </h3>

                    <div class="pull-left mb16 col-md-6" t-if="slideview.tag_ids" style="padding-left: 0px;">
                        <i class="fa fa-tags"></i>
                        <t t-foreach="slideview.tag_ids" t-as="att_tag">
                            <a t-att-href="url_for('/channel/#{slug(channel)}/view/#{slug(attachment)}') + '?' + keep_query( 'search', 'filters', 'sorting' ,tags=att_tag.name)">
                                <span t-attf-class="badge slide-badge #{tags and tags == att_tag.name and 'badge-active' ''}" t-field="att_tag.name"/>
                            </a>
                        </t>
                    </div>
                    <div class="pull-right mb16 col-md-6 text-right text-muted" style="padding-right: 0px">
                        <a class="slide-like" data-count-el='.count-likes' t-attf-data-href="/channel/#{slug(channel)}/view/#{slug(slideview)}/like"><i class="fa fa-thumbs-up fa-2x"></i> Like</a>
                        <a class="slide-unlike" data-count-el=".count-dislikes" t-attf-data-href="/channel/#{slug(channel)}/view/#{slug(slideview)}/dislike"><i class="fa fa-thumbs-down fa-2x"></i></a>
                    </div>
                </div>
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="padding: 0px;">
                    <div class="col-lg-1 col-md-1 col-sm-1 col-xs-2" style="padding: 0px;">
                        <a t-attf-href="/channel/#{slug(channel)}">
                            <img src="/website_slides/static/description/odoo-logo.jpg" class="img-responsive" style="border: 1px solid #CCC;"/>
                        </a>
                    </div>
                    <div class="col-lg-11 col-md-11 col-sm-11 col-xs-10" style="padding-right:0px;padding-left: 10px;">
                        <div class="pull-right text-right col-md-4" style="padding-right:0px;">
                            <div style="border-bottom: 1px solid #CCC; font-size:130%">
                                <b><t t-esc="slideview.slide_views"/></b> Views
                            </div>
                            <div class="small text-muted mt4">
                                <i class="count-likes fa fa-thumbs-up" style="padding-left: 10px;">
                                    <t t-esc="slideview.likes"/>
                                </i>
                                <i class="count-dislikes fa fa-thumbs-down">
                                    <t t-esc="slideview.dislikes"/>
                                </i>
                            </div>
                        </div>

                        <a t-attf-href="/channel/#{slug(channel)}">
                            <p t-field="channel.name"/>
                        </a>
                        
                        <div class="col-md-6" style="padding-left:0">
                            <t t-call="website_mail.follow">
                                <t t-set="email" t-value="user.email"/>
                                <t t-set="object" t-value="channel"/>
                            </t>
                        </div>
                        <t t-call="website.publish_management">
                            <t t-set="object" t-value="slideview"/>
                            <t t-set="publish_edit" t-value="True"/>
                        </t>
                    </div>
                </div>
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="padding: 10px 0px 10px 0px;">
                    <ul class="nav nav-tabs" role="tablist">
                        <li><a href="#about" role="tab" data-toggle="tab">About</a></li>
                        <li><a href="#share" role="tab" data-toggle="tab">Share</a></li>
                        <li class="active"><a href="#discuss" role="tab" data-toggle="tab">Discuss</a></li>
                        <li><a href="#transcript" role="tab" data-toggle="tab">Transcript</a></li>
                    </ul>
                    <div class="tab-content" style="padding: 20px 5px 5px 5px;">
                        <div class="tab-pane fade" id="about">
                            <div t-field="slideview.website_description"/>
                        </div>
                        <div class="tab-pane fade" id="share">
                            <span class="lead">Share:</span>
                            <p class="oe_share">
                                <a target="_Blank" class="oe_share_facebook" href="https://www.facebook.com/sharer/sharer.php?u={url}"><i class="fa fa-facebook-square fa-2x"></i></a>
                                <a target="_Blank" class="oe_share_twitter" href="https://twitter.com/intent/tweet?text={title}&amp;url={url}"><i class="fa fa-twitter fa-2x"></i></a>
                                <a target="_Blank" class="oe_share_linkedin" href="http://www.linkedin.com/shareArticle?mini=true&amp;url={url}&amp;title={title}&amp;"><i class="fa fa-linkedin fa-2x"></i></a>
                                <a target="_Blank" class="oe_share_google" href="https://plus.google.com/share?url={url}"><i class="fa fa-google-plus-square fa-2x"></i></a>
                                <a href="mailto:?body={url}&amp;subject={title}"><i class="fa fa-envelope-o fa-2x"></i></a>					            
                            </p>
                            <input type="text" class="form-control" t-att-value="shareurl" readonly="readonly" onClick="this.select();"/>
                            <span class="help-block"> -- copy above link to share</span>
                            <span class="lead">Embed:</span>
                            <textarea id="slide_embed_code" class="form-control" readonly="readonly" onClick="this.select();"><t t-esc="embedcode"/></textarea>
                            <span class="help-block"> -- copy above embed code to share</span>
                            <t t-if="slideview.datas">														
                                <div class="input-group col-lg-2 col-md-2 col-sm-12 col-xs-12">
                                    <span class="input-group-btn">
                                        <button class="btn btn-default" type="button" id="btnminus" field="page"><span class="glyphicon glyphicon-minus-sign"/></button>
                                    </span>
                                    <input type="text" class="form-control text-center" value="0" name="page" readonly="readonly"/>
                                    <span class="input-group-btn">
                                        <button class="btn btn-default" type="button" id="btnplus" field="page"><span class="glyphicon glyphicon-plus-sign"/></button>
                                    </span>
                                </div>
                                <span class="help-block"> -- Enter start page</span>
                            </t>
                        </div>
                        <div class="tab-pane fade in active" id="discuss">                       	
                            <form id="comment" t-attf-action="/slides/comment/#{slideview.id}" method="POST">
                                <div class="media">
                                    <span class="pull-left">
                                        <img class="img img-circle media-object" t-att-src="'/website/image?model=res.partner&amp;field=image_small&amp;id='+str(user_id.partner_id.id)" style="width: 30px"/>
                                    </span>
                                    <div class="media-body">
                                        <textarea rows="3" name="comment" class="form-control" placeholder="Write a comment..."></textarea>
                                        <button type="submit" class="btn btn-primary mt8">Post</button>
                                    </div>
                                </div>
                            </form>
                            <ul class="media-list">
                                <li t-foreach="comments" t-as="message" class="media">
                                    <span class="pull-left">
                                        <img class="media-object img img-circle" t-att-src="'/website/image?model=mail.message&amp;field=author_avatar&amp;id='+str(message.id)" style="width: 30px"/>
                                    </span>
                                    <div class="media-body">
                                        <t t-call="website.publish_short">
                                            <t t-set="object" t-value="message"/>
                                        </t>
                                        <span t-field="message.author_id" style="display: inline-block;" t-field-options='{"widget": "contact", "fields": ["name"]}'/>
                                        <span class="text-muted">on<span t-field="message.date"/></span>
                                        <div t-field="message.body" class="discussion_scroll_post"></div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                        <div class="tab-pane fade" id="transcript">
                            <p t-field="slideview.index_content"></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
                <ul class="nav nav-tabs" role="tablist">
                    <li class="active"><a href="#related" data-toggle="tab">Related</a></li>
                    <li><a href="#most_viewed" data-toggle="tab">Most Viewed</a></li>
                </ul>
                <div class="tab-content">
                    <div id="related" class="tab-pane active">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 slide-box">
                            <ul class="media-list">
                                <t t-foreach="related_ids" t-as="attachment">
                                    <t t-call="website_slides.slide-box"/>
                                </t>
                            </ul>
                        </div>
                    </div>
                    <div id="most_viewed" class="tab-pane">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 slide-box">
                            <ul class="media-list">
                                <t t-foreach="most_viewed_ids" t-as="attachment">
                                    <t t-call="website_slides.slide-box"/>
                                </t>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </template>

        <template id="slide-box" name="Slide Box">
            <li class="media slide-container">
                <a class="pull-left" t-attf-href="/channel/#{slug(channel)}/view/#{slug(attachment)}#{url_for('') + '?' + keep_query( 'search', 'filters', 'sorting', 'tags')}">
                    <t t-if="not attachment.youtube_id">
                        <img class="media-object image-box" t-attf-src="/slides/thumb/#{attachment.id}"/>
                    </t>
                    <t t-if="attachment.youtube_id">
                        <img class="media-objecti image-box" t-att-src="attachment.image"/>
                    </t>
                </a>
                <div class="media-heading">
                    <div class="text-truncation" t-att-title="attachment.name">
                        <t t-esc="attachment.name"/>
                    </div>
                    <small class="text-muted">
                        <div class="pull-left"><t t-esc="attachment.slide_views"/> Views</div><br/>
                        <div class="pull-left"><timeago class="timeago" t-att-title="attachment.create_date"></timeago></div>
                    </small>
                </div>
            </li>
        </template>

        <template id="content_new_slide" inherit_id="website.user_navbar">
            <xpath expr="//ul[@id='oe_systray']/li/ul[@class='dropdown-menu oe_content_menu']" position="inside">
                <li><a id="create-new-slide" href="#" data-action="new_slide">New Slide</a></li>
            </xpath>
        </template>

        <template id="assets_editor_slides" inherit_id="website.assets_editor" name="Add Slides">
            <xpath expr="." position="inside">
                <script type="text/javascript" src="/website_slides/static/lib/pdfjs/build/pdf.js"/>
                <script type="text/javascript" src="/web/static/lib/jquery.textext/jquery.textext.js"/>
                <script type="text/javascript" src="/website_slides/static/src/js/website_slides.editor.js"></script>
                <link rel='stylesheet' href="/web/static/lib/jquery.textext/jquery.textext.css"/>
            </xpath>
        </template>

    </data>
</openerp>
